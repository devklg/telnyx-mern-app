# ===========================================
# BMAD V4 - Environment Configuration
# ===========================================
# Copy this file to .env and fill in your values
# NEVER commit .env to version control
# ===========================================

# -------------------------------------------
# SERVER CONFIGURATION
# -------------------------------------------
NODE_ENV=development
PORT=3550
FRONTEND_URL=http://localhost:3500

# API Configuration
API_PREFIX=/api
API_VERSION=v1

# Server Timeouts
REQUEST_TIMEOUT=30000
SHUTDOWN_TIMEOUT=10000

# -------------------------------------------
# DATABASE CONNECTIONS
# -------------------------------------------

# MongoDB (Document Store)
# Used for: leads, calls, campaigns, conversations
MONGODB_URI=mongodb://localhost:27017/bmad_v4
MONGODB_MAX_POOL_SIZE=10
MONGODB_MIN_POOL_SIZE=5

# PostgreSQL (Relational Database)
# Used for: users, organizations, call_logs, structured data
POSTGRES_URL=postgresql://postgres:password@localhost:5432/bmad_v4
POSTGRES_MAX_CONNECTIONS=20
POSTGRES_SSL=false

# Neo4j (Graph Database)
# Used for: relationship mapping, entity connections
NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=password
NEO4J_DATABASE=neo4j

# Redis (Cache & Session Store)
# Used for: sessions, rate limiting, job queues
REDIS_URL=redis://localhost:6379
REDIS_DB=0
REDIS_TTL=3600

# ChromaDB (Vector Database)
# Used for: embeddings, semantic search
CHROMA_URL=http://localhost:8000
CHROMA_COLLECTION=bmad_embeddings

# -------------------------------------------
# TELNYX TELEPHONY INTEGRATION
# -------------------------------------------
TELNYX_API_KEY=your_telnyx_api_key_here
TELNYX_PUBLIC_KEY=your_telnyx_public_key_here
TELNYX_APP_ID=your_telnyx_app_id_here
TELNYX_PHONE_NUMBER=+1234567890
TELNYX_WEBHOOK_URL=https://your-domain.com/api/webhooks/telnyx

# Voice Agent Configuration
VOICE_AGENT_URL=http://localhost:3650
VOICE_AGENT_TIMEOUT=60000

# -------------------------------------------
# AUTHENTICATION & SECURITY
# -------------------------------------------

# JWT Configuration
JWT_SECRET=your_super_secure_jwt_secret_minimum_32_characters
JWT_EXPIRES_IN=7d
JWT_REFRESH_SECRET=your_super_secure_refresh_token_secret
JWT_REFRESH_EXPIRES_IN=30d

# Session Configuration
SESSION_SECRET=your_session_secret_minimum_32_characters
SESSION_MAX_AGE=86400000

# Password Policy
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SYMBOLS=true
BCRYPT_ROUNDS=10

# API Keys (if using API key authentication)
API_KEY_HEADER=X-API-Key

# -------------------------------------------
# CORS CONFIGURATION
# -------------------------------------------
CORS_ORIGIN=http://localhost:3500,http://localhost:3000
CORS_CREDENTIALS=true
CORS_MAX_AGE=86400

# -------------------------------------------
# RATE LIMITING
# -------------------------------------------
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# Specific endpoint limits
RATE_LIMIT_AUTH_MAX=5
RATE_LIMIT_API_MAX=100
RATE_LIMIT_WEBHOOK_MAX=1000

# -------------------------------------------
# LOGGING CONFIGURATION
# -------------------------------------------
LOG_LEVEL=info
LOG_FORMAT=combined
LOG_DIR=./logs
LOG_MAX_FILES=14d
LOG_MAX_SIZE=20m

# Morgan HTTP Logging
MORGAN_FORMAT=dev
MORGAN_SKIP_HEALTH_CHECKS=true

# -------------------------------------------
# EMAIL CONFIGURATION (Optional)
# -------------------------------------------
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_specific_password
EMAIL_FROM=noreply@bmad.com
EMAIL_FROM_NAME=BMAD V4

# -------------------------------------------
# TCPA COMPLIANCE
# -------------------------------------------
TCPA_COMPLIANCE_ENABLED=true
DNC_CHECK_ENABLED=true
CONSENT_REQUIRED=true
CALL_TIME_RESTRICTION_ENABLED=true
CALL_TIME_START=08:00
CALL_TIME_END=21:00
CALL_TIME_TIMEZONE=America/New_York

# -------------------------------------------
# MONITORING & OBSERVABILITY
# -------------------------------------------
METRICS_ENABLED=true
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30000

# Sentry (Error Tracking - Optional)
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=1.0

# -------------------------------------------
# FILE STORAGE (Optional)
# -------------------------------------------
STORAGE_TYPE=local
STORAGE_PATH=./uploads
MAX_FILE_SIZE=10485760

# AWS S3 Configuration (if using S3)
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_S3_BUCKET=

# -------------------------------------------
# WEBHOOK CONFIGURATION
# -------------------------------------------
WEBHOOK_SECRET=your_webhook_secret_for_validation
WEBHOOK_RETRY_ATTEMPTS=3
WEBHOOK_TIMEOUT=5000

# -------------------------------------------
# FEATURE FLAGS
# -------------------------------------------
FEATURE_VOICE_AGENT=true
FEATURE_ANALYTICS=true
FEATURE_LEAD_SCORING=true
FEATURE_REAL_TIME_DASHBOARD=true
FEATURE_EXPORT_REPORTS=true

# -------------------------------------------
# DEVELOPMENT TOOLS
# -------------------------------------------
DEBUG=false
VERBOSE_ERRORS=false
ENABLE_SWAGGER_DOCS=true
SWAGGER_PATH=/api-docs

# Database Seeding
SEED_DATABASE=false
SEED_ADMIN_EMAIL=admin@bmad.com
SEED_ADMIN_PASSWORD=ChangeMe123!

# -------------------------------------------
# PRODUCTION OVERRIDES
# -------------------------------------------
# In production, ensure you set:
# - NODE_ENV=production
# - Strong JWT_SECRET and SESSION_SECRET
# - Proper CORS_ORIGIN (your production domain)
# - TELNYX_WEBHOOK_URL (your production webhook endpoint)
# - LOG_LEVEL=warn or error
# - DEBUG=false
# - Database URLs with production credentials
# - Enable POSTGRES_SSL=true
# - Configure proper monitoring (Sentry, etc.)
# -------------------------------------------
